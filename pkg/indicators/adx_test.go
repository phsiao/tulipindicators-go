package indicators

import (
	"fmt"
	"testing"

	"github.com/stretchr/testify/assert"
)

/*
date	    high	low	    close	dx
2005-11-01	82.15	81.29	81.59
2005-11-02	81.89	80.64	81.06
2005-11-03	83.03	81.31	82.87
2005-11-04	83.30	82.65	83.00
2005-11-07	83.85	83.07	83.61
2005-11-08	83.90	83.11	83.15
2005-11-09	83.33	82.49	82.84
2005-11-10	84.30	82.30	83.99
2005-11-11	84.84	84.15	84.55	41.38
2005-11-14	85.00	84.11	84.36	44.29
2005-11-15	85.90	84.03	85.53	49.42
2005-11-16	86.58	85.39	86.54	54.92
2005-11-17	86.98	85.76	86.89	59.99
2005-11-18	88.00	87.17	87.77	65.29
2005-11-21	87.87	87.01	87.29	67.36
*/

func TestADX(t *testing.T) {

	input := [][]float64{
		{82.15, 81.89, 83.03, 83.30, 83.85, 83.90, 83.33, 84.30,
			84.84, 85.00, 85.90, 86.58, 86.98, 88.00, 87.87},
		{81.29, 80.64, 81.31, 82.65, 83.07, 83.11, 82.49, 82.30,
			84.15, 84.11, 84.03, 85.39, 85.76, 87.17, 87.01},
		{81.59, 81.06, 82.87, 83.00, 83.61, 83.15, 82.82, 83.99,
			84.55, 84.36, 85.53, 86.65, 86.89, 87.77, 87.29},
	}

	output, _, err := ADX(input[0], input[1], input[2], 5)
	assert.NoError(t, err)

	assert.Equal(t, fmt.Sprintf("%.2f", output[0]), "41.38")
}
